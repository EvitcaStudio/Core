<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../">
  <title data-ice="title">src/submodules/Tween/src/tween.mjs | Core</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="A plugin that will enable pathfinding functionality."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Core"><meta property="twitter:description" content="A plugin that will enable pathfinding functionality."><meta property="twitter:image" content="./evitcastudio_round_branding.png"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.png" style="width:34px;"></a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/EvitcaStudio/Core"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/index.mjs~CoreEngine.html">CoreEngine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Core">Core</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#submodules-collector-src">submodules/Collector/src</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/Collector/src/collector.mjs~CollectorSingleton.html">CollectorSingleton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Collector">Collector</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#submodules-pulse-src">submodules/Pulse/src</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/Pulse/src/pulse.mjs~PulseComponent.html">PulseComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Pulse">Pulse</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#submodules-resonance-src">submodules/Resonance/src</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/Resonance/src/resonance.mjs~ResonanceSingleton.html">ResonanceSingleton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/Resonance/src/sound.mjs~Sound.html">Sound</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Resonance">Resonance</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#submodules-statemanager-src">submodules/StateManager/src</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/StateManager/src/state-manager.mjs~State.html">State</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/StateManager/src/state-manager.mjs~StateManager.html">StateManager</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#submodules-tween-src">submodules/Tween/src</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/Tween/src/tween.mjs~Tween.html">Tween</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#submodules-utils-src">submodules/Utils/src</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/submodules/Utils/src/utils.mjs~UtilsSingleton.html">UtilsSingleton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Utils">Utils</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/submodules/Tween/src/tween.mjs</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { Logger } from &apos;./vendor/logger.min.mjs&apos;;

/**
* Class for creating a tweening animation
* @class Tween  
* @license Tween does not have a license at this time. For licensing contact the author
* @author https://github.com/doubleactii
*/
class Tween {
    /**
     * @param {Object} [pOtions={}] - The options for the tween animation
     * @param {Object} [pOtions.start={}] - The starting properties of the animation
     * @param {Object} [pOtions.end={}] - The end properties of the animation
     * @param {number} [pOtions.duration=1000] - The duration of the animation in milliseconds
     * @param {string} [pOtions.easing=&quot;linear&quot;] - The easing function to use for the animation
     */
    constructor({ start = {}, end = {}, duration = 1000, easing = Tween.linear } = {}) {
        this._build(start, end, duration, easing);
    }

    // Robert Penner&apos;s easing functions
    static linear(t, b, c, d) {
        return c * t / d + b;
    }
    static easeInQuad(t, b, c, d) {
        return c * (t /= d) * t + b;
    }
    static easeOutQuad(t, b, c, d) {
        return -c * (t /= d) * (t - 2) + b;
    }
    static easeInOutQuad(t, b, c, d) {
        if ((t /= d / 2) &lt; 1) return c / 2 * t * t + b;
        return -c / 2 * ((--t) * (t - 2) - 1) + b;
    }
    static easeInSine(t, b, c, d) {
        return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;
    }
    static easeOutSine(t, b, c, d) {
        return c * Math.sin(t / d * (Math.PI / 2)) + b;
    }
    static easeInOutSine(t, b, c, d) {
        return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;
    }
    static easeInExpo(t, b, c, d) {
        return (t == 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;
    }
    static easeOutExpo(t, b, c, d) {
        return (t == d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;
    }
    static easeInOutExpo(t, b, c, d) {
        if (t == 0) return b;
        if (t == d) return b + c;
        if ((t /= d / 2) &lt; 1) return c / 2 * Math.pow(2, 10 * (t - 1)) + b;
        return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;
    }
    static easeInCirc(t, b, c, d) {
        return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;
    }
    static easeOutCirc(t, b, c, d) {
        return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;
    }
    static easeInOutCirc(t, b, c, d) {
        if ((t /= d / 2) &lt; 1) return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;
        return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;
    }
    static easeInCubic(t, b, c, d) {
        return c * (t /= d) * t * t + b;
    }
    static easeOutCubic(t, b, c, d) {
        return c * ((t = t / d - 1) * t * t + 1) + b;
    }
    static easeInOutCubic(t, b, c, d) {
        if ((t /= d / 2) &lt; 1) return c / 2 * t * t * t + b;
        return c / 2 * ((t -= 2) * t * t + 2) + b;
    }
    static easeInQuart(t, b, c, d) {
        return c * (t /= d) * t * t * t + b;
    }
    static easeOutQuart(t, b, c, d) {
        return -c * ((t = t / d - 1) * t * t * t - 1) + b;
    }
    static easeInOutQuart(t, b, c, d) {
        if ((t /= d / 2) &lt; 1) return c / 2 * t * t * t * t + b;
        return -c / 2 * ((t -= 2) * t * t * t - 2) + b;
    }
    static easeInQuint(t, b, c, d) {
        return c * (t /= d) * t * t * t * t + b;
    }
    static easeOutQuint(t, b, c, d) {
        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;
    }
    static easeInOutQuint(t, b, c, d) {
        if ((t /= d / 2) &lt; 1) return c / 2 * t * t * t * t * t + b;
        return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;
    }
    static easeInElastic(t, b, c, d) {
        var s = 1.70158;
        var p = 0;
        var a = c;
        if (t == 0) return b;
        if ((t /= d) == 1) return b + c;
        if (!p) p = d * .3;
        if (a &lt; Math.abs(c)) {
            a = c;
            var s = p / 4;
        } else {
			// Handle the Math.asin(0 / 0) case
			if (c === 0 &amp;&amp; a === 0) {
				s = p / (2 * Math.PI) * Math.asin(1);
			} else {
				var s = p / (2 * Math.PI) * Math.asin(c / a);
			}
		}
        return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
    }
    static easeOutElastic(t, b, c, d) {
        var s = 1.70158;
        var p = 0;
        var a = c;
        if (t == 0) return b;
        if ((t /= d) == 1) return b + c;
        if (!p) p = d * .3;
        if (a &lt; Math.abs(c)) {
            a = c;
            var s = p / 4;
        } else {
			// Handle the Math.asin(0 / 0) case
			if (c === 0 &amp;&amp; a === 0) {
				s = p / (2 * Math.PI) * Math.asin(1);
			} else {
				var s = p / (2 * Math.PI) * Math.asin(c / a);
			}
		}
        return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;
    }
    static easeInOutElastic(t, b, c, d) {
        var s = 1.70158;
        var p = 0;
        var a = c;
        if (t == 0) return b;
        if ((t /= d / 2) == 2) return b + c;
        if (!p) p = d * (.3 * 1.5);
        if (a &lt; Math.abs(c)) {
            a = c;
            var s = p / 4;
        } else {
			// Handle the Math.asin(0 / 0) case
			if (c === 0 &amp;&amp; a === 0) {
				s = p / (2 * Math.PI) * Math.asin(1);
			} else {
				var s = p / (2 * Math.PI) * Math.asin(c / a);
			}
		}
        if (t &lt; 1) return -.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
        return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * .5 + c + b;
    }
    static easeInBack(t, b, c, d) {
        var s = 1.70158;
        return c * (t /= d) * t * ((s + 1) * t - s) + b;
    }
    static easeOutBack(t, b, c, d) {
        var s = 1.70158;
        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;
    }
    static easeInOutBack(t, b, c, d) {
        var s = 1.70158;
        if ((t /= d / 2) &lt; 1) return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;
        return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;
    }

    static easeInBounce(t, b, c, d) {
        return c - Tween.easeOutBounce(d - t, 0, c, d) + b;
    }

    static easeOutBounce(t, b, c, d) {
        t /= d;
        if (t &lt; 1/2.75) {
            return c * 7.5625 * t * t + b;
        }
        
        if (t &lt; 2/2.75) {
            t -= 1.5/2.75;
            return c * (7.5625 * t * t + 0.75) + b;
        }
        
        if (t &lt; 2.5/2.75) {
            t -= 2.25/2.75;
            return c * (7.5625 * t * t + 0.9375) + b;
        } else {
            t -= 2.625/2.75;
            return c * (7.5625 * t * t + 0.984375) + b;
        }
    }

    static easeInOutBounce(t, b, c, d) {
        if (t &lt; d*0.5) {
            return (Tween.easeInBounce(t*2, 0, c, d)*0.5 + b);
        }
        return (Tween.easeOutBounce(t*2 - d, 0, c, d)*0.5 + c*0.5 + b);
    }
	/**
	 * @param {number} pNumber - The number to clamp
	 * @param {number} pMin - The minimum number 
	 * @param {number} pMax - The maximum number
	 * @returns {number} The number clamped between the minimum and maximum values
	 */
	static _clamp(pNumber, pMin = 0, pMax = 1) {
		return Math.max(pMin, Math.min(pNumber, pMax));
	}
	/**
	 * Converts an Hex color value to an array of [r, g, b].
	 *
	 * @private
	 * @param {string} pHex - The Hex color in the form &quot;#fff&quot; or &quot;#ffffff&quot; or tagless.
	 * @return {Array} The array [r, g, b].
	 */
	static _hexToRgb(pHex) {
		pHex = pHex.replace(&apos;#&apos;, &apos;&apos;);
		if (pHex.length === 3) {
			pHex = pHex.replace(new RegExp(&apos;(.)&apos;, &apos;g&apos;), &apos;$1$1&apos;);
		}
		pHex = pHex.match(new RegExp(&apos;..&apos;, &apos;g&apos;));
		const r = Tween._clamp(parseInt(pHex[0], 16), 0, 255);
		const g = Tween._clamp(parseInt(pHex[1], 16), 0, 255);
		const b = Tween._clamp(parseInt(pHex[2], 16), 0, 255);
		return [r, g, b];
	}
	/**
	 * Converts an array of [r, g, b] to an Hex color code.
	 * 
	 * @private
	 * @param {Array} pColorArray - The rgb color array to convert into a hex
	 * return {string} The hex color
	 */
	static _rgbToHex(pColorArray) {
		if (Array.isArray(pColorArray)) {
			return &apos;#&apos; + pColorArray.map((pColor) =&gt; Math.abs(Math.round(pColor)).toString(16).padStart(2, &apos;0&apos;)).join(&apos;&apos;);
		}
	}
	/**
	 * The version of the module.
	 */
	version = &quot;VERSION_REPLACE_ME&quot;;
    /**
     * Builds/Rebuilds the tween object with new info
     * @param {Object} pStart - The start object containing the start values
     * @param {Object} pEnd - The end object containing the end values
     * @param {number} pDuration -  The duration of the effect
     * @param {function} pEasing - The easing function to use
     */
    _build(pStart, pEnd, pDuration, pEasing) {
        this.start = pStart;
        this.end = pEnd;
        this.duration = pDuration;
        this.easing = typeof(pEasing) === &apos;function&apos; ? pEasing : Tween.linear;
        this.events = {};
        this.exportedValues = {};
        this.tweening = false;
        this.update = null;
        this.paused = false;
		this.lastTime = 0;
        this.elapsed = 0;
    }
    /**
     * @param {Object} [pOtions={}] - The options for the tween animation
     * @param {Object} [pOtions.start={}] - The starting properties of the animation
     * @param {Object} [pOtions.end={}] - The end properties of the animation
     * @param {number} [pOtions.duration=1000] - The duration of the animation in milliseconds
     * @param {string} [pOtions.easing=&quot;linear&quot;] - The easing function to use for the animation
     */
    build({ start = {}, end = {}, duration = 1000, easing = Tween.linear } = {}) {
        this._build(start, end, duration, easing);
        return this;
    }
    /**
     * Attaches a callback to the specified event.
     * @param {Object} pEvent - The event to attach the callback to
     * @param {Function} pCallback - The function to be called when the event is triggered
     * @return {Tween} The Tween instance
     */
    on(pEvent, pCallback) {
        if (typeof(pCallback) === &quot;function&quot;) {
            switch (pEvent) {
                case &quot;start&quot;:
                case &quot;end&quot;:
                case &quot;pause&quot;:
                case &quot;resume&quot;:
                    this.events[pEvent] = pCallback;
                    break;
                default:
                    logger.prefix(&apos;Tween-Module&apos;).error(`The event &quot;${pEvent}&quot; is not supported.`);
            }
        } else {
            logger.prefix(&apos;Tween-Module&apos;).error(`The callback for event &quot;${pEvent}&quot; is not a function.`);
        }
        return this;
    }
    /**
     * Update each frame.
     */
    animationFrame = () =&gt; {
        if (!this.tweening || this.paused) return;
		const now = Date.now();
		if (!this.lastTime) this.lastTime = now;
        this.elapsed += now - this.lastTime;
        let progress = this.elapsed / this.duration;
        
        if (this.oscillating) {
            progress = (1 - Math.cos(progress * Math.PI)) / 2;
        }
        
        if (progress &gt; 1) {
            progress = 1;
        }

		for (let key in this.end) {
			let startValue = this.start[key];
			let endValue = this.end[key];
			if (typeof(startValue) === &quot;string&quot; &amp;&amp; (startValue.length === 3 || startValue.length === 6) || startValue.length === 4 || startValue.length === 7) {
				startValue = Tween._hexToRgb(startValue);
				endValue = Tween._hexToRgb(endValue);
				const currentRGB = [
					this.easing(progress, startValue[0], endValue[0] - startValue[0], 1),
					this.easing(progress, startValue[1], endValue[1] - startValue[1], 1),
					this.easing(progress, startValue[2], endValue[2] - startValue[2], 1)
				];
				this.exportedValues[key] = Tween._rgbToHex(currentRGB);
			} else {
				this.exportedValues[key] = this.easing(progress, startValue, endValue - startValue, 1);
			}
		}

        this.update(this.exportedValues);

        if (progress === 1 &amp;&amp; !this.oscillating) {
            this.stop();
            if (this.events.end) {
                this.events.end();
            }
        } else {
            requestAnimationFrame(this.animationFrame);
        }
		this.lastTime = now;
    }
    /**
     * Animates the tween by oscillating between the start and end properties.
     * @param {function} pUpdate - A callback function to update the values during the oscillation.
     * @param {boolean} [pOscillate=false] - A flag to indicate if the tween should oscillate.
     * @return {Tween} - Returns the Tween instance for method chaining.
     */
    animate(pUpdate, pOscillate = false) {
        if (typeof(pUpdate) !== &quot;function&quot;) {
            logger.prefix(&apos;Tween-Module&apos;).error(&quot;The pUpdate parameter passed to animate is not a function.&quot;);
            return;
        }
        if (this.tweening) return;
        let startProperties = Object.keys(this.start);
        let endProperties = Object.keys(this.end);

        if (!startProperties.length || !endProperties.length) {
            logger.prefix(&apos;Tween-Module&apos;).error(&quot;The start object or the end object has no properties.&quot;);
            return;
        }

        if (!startProperties.every(prop =&gt; endProperties.includes(prop))) {
            logger.prefix(&apos;Tween-Module&apos;).error(&quot;The end object is missing properties that the start object has.&quot;);
            return;
        }

        this.update = pUpdate;
        this.tweening = true;
		this.elapsed = 0;
        this.oscillating = pOscillate;

        if (this.events.start) {
            this.events.start();
        }
        requestAnimationFrame(this.animationFrame);
        return this;
    }
    /**
     * Resumes the tween animation
     * @returns {Tween} The instance of the Tween object
     */
    resume() {
        if (this.paused) {
            this.lastTime = Date.now();
            this.paused = false;
            if (this.events.resume) {
                this.events.resume();
            }
            requestAnimationFrame(this.animationFrame);
        }
        return this;
    }
    /**
     * Pauses the tween animation
     * @returns {Tween} The instance of the Tween object
     */
    pause() {
        if (!this.paused) {
            this.paused = true;
            if (this.events.pause) {
                this.events.pause();
            }
        }
        return this;
    }
    /**
     * Stops the tween and clears all data.
     */
    stop() {
        this.tweening = false;
        this.oscillating = false;
        this.update = null;
        this.elapsed = 0;
		this.lastTime = 0;
        this.paused = false;
        for (const prop in this.exportedValues) {
            if (this.exportedValues.hasOwnProperty(prop)) {
                delete this.exportedValues[prop];
            }
        }
    }
}

/**
 * The logger for this module.
 * @ignore
 */
const logger = new Logger();
logger.registerType(&apos;Tween-Module&apos;, &apos;#ff6600&apos;);

export { Tween };</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
